<?php

namespace App\Http\Controllers;

use App\Http\Controllers\Controller;
use Illuminate\Support\Facades\Http;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Validator;

class AdminController extends Controller
{
    public function panel()
    {
        return view('admin-panel');
    }

    public function update()
    {
        // $newApps = [281990, 892970,954850,1250410,782330,379720,489830,962130,774291,890720,893850,466630,383870,746850,979070,1243960,837470,362620,382310,548430,271590,454120,239030,1012560,1288760,1240210,739630,1281630,683320,286160,504230,621060,648800,613100,846770,1097150,1307890,1213210,268650,895870,1145360,911430,1410710,897450,1237970,252490,412020,570940,604540,648350,1030840,1237950,261550,374320,1151640,773370,1328720,868360,1062090,1468720,400,2820,4700,4760,8870,10500,34030,65980,201271,214510,214950,236850,244160,252870,285160,287980,1127500,288470,325610,345240,345260,392160,409720,427940,445220,484900,494840,507490,541210,563200,582010,629820,632360,712100,727130,738520,765810,758870,779340,840390,885970,894020,906100,920210,950180,969760,973810,979690,1009560,1029780,1073910,1082430,1096530,1097130,1103230,1113120,1115050,1124180,1133120,1134710,1139900,1167680,578650,1174180,1205450,1210320,1213230,1244800,1245620,1256230,1264280,1272320,1280190,1289340,1290000,1318690,1328670,1371500,1372530,1390190,1395760,1411740,1430760,1459500,1465360,1469690,1472560,1494260,1531540,1543150,1544360,1593030,1601580,1608230,41700,1643320,1657050,1672970,1696810,1716740,1779200,1880610,1124300,1366540,1167630,289070,526870,255710,464920,275850,220200,582160,1091500,1066780,703080,803050,976730,711980,361420,264710,396750,848450,289130,392110,1161580,1128920,359320,1158310,700600,1714040,1659040,863550,236870,427520,244850,413150,1127400,508440,346010,466560,1240440,105600,1455840,233450,492720,457140,230290,314650,803330,377160,367450,352720,736260,671440,8930,816430,323190,853550,1049410,870200,17390,535930,1196080,493340,294100,591370,881100,440,322500,1291340,730,409710,203770,227300,22380,447020,787860,240720,394360,638230,1536610,753640,343090,690040,221910,391540,1252330,1142710,1525620,1620250,1098292,1098293,1098300,1749101,1749103,1749102,1749100,1626003,1626001,1626002,1626000,1460020,1460021,1195480,1746860,1266230,1278300,1275730,1236790,435910,1536370,1291400,1643930,801860,802640,1283090,1283091,1430610,1530640,1797340,1946960,1393110,1393111,1425430,1425450,771300,1312940,1448100,1448101,1395730,48240,375910,204290,204287,204288,204289,204284,204285,204286,204283,204281,204282,416480,441720,500370,526040,986250,1621110,468726,367330,405130,610695,468737,610705,610702,468723,433520,610704,610692,610693,610700,610701,610706,610709,468730,610708,610698,437590,468736,468734,610697,610699,610694,468739,458910,468720,468721,610690,468727,425960,610691,468729,457180,468735,438980,468724,468722,468731,610696,730, 578080, 105600, 292030, 431960, 550, 381210, 346110, 1245620, 620, 659, 1172620, 275850, 107410, 433850, 255710, 814380, 477160, 10, 552520, 284160, 220, 240, 813780, 400, 222880, 244850, 433340, 1172380, 232090, 108600, 534380, 365590, 20920, 552500, 20900, 70, 223470, 231430, 286690, 206420, 440900, 447040, 233450, 287700, 1113000, 890030, 890031, 890032, 750920, 233860, 683320, 206440, 601150, 287390, 265930, 493340, 214950, 113200, 307690, 6060, 234140, 346010, 213670, 274190, 246620, 274170, 1250, 994280, 214490, 815370, 431240, 33230, 286160, 500, 285900, 200260, 637650, 364360, 307780, 22330, 863550, 1089980, 728880, 108710, 244450, 105450, 480490, 107100, 420530, 447530, 751780, 223591, 573090, 32470, 552100, 274940, 4500, 668630, 933110, 420, 257510, 434570, 110800, 32370, 266840, 476600, 476620, 21690, 420290, 569480, 207140, 104900, 1149460, 502500, 447020, 4700, 373420, 245170, 1100600, 287290, 42910, 337320, 578650, 380, 1088850, 434650, 33930, 57300, 962730, 823130, 1124300, 365360, 22320, 374040, 80, 100, 1184370, 32440, 283640, 450540, 570, 22300, 1102190, 492720, 285920, 233130, 1046030, 233270, 440, 673950, 445980, 291650, 1113560, 601430, 233720, 365450, 282800, 232430, 42960, 257850, 337340, 503560, 50, 214560, 246900, 102500, 332310, 42710, 42700, 300, 285190, 292120, 20510, 34030, 719040, 265300, 1149620, 19900, 4760, 760060, 213610, 256290, 292730, 274520, 899770, 601840, 738520, 6000, 451340, 866800, 682990, 411300, 2990, 257420, 784150, 420110, 559650, 2280, 560130, 585420, 421020, 1490890, 1135690, 6910, 878750, 1161580, 233290, 410900, 712100, 2600, 282900, 265550, 294860, 223100, 969990, 6020, 445220, 287450, 206190, 280, 245620, 729040, 42680, 130, 1017900, 462780, 2310, 232890, 446800, 1017180, 400910, 1016920, 519190, 914620, 1244460, 6860, 329050, 108800, 214340, 921570, 552620, 431730, 44350, 4920, 4932, 19680, 464060, 1089090, 814540, 593600, 340, 21090, 21110, 21120, 266510, 382310, 246420, 813630, 329430, 57690, 673880, 491950, 45760, 1016800, 865360, 1137460, 1126290, 462770, 1111460, 266010, 578620, 320, 601220, 430960, 354140, 1126320, 291860, 1136160, 222940, 843380, 614570, 328080, 331600, 257350, 1102130, 245470, 573100, 1150080, 502520, 586140, 446020, 584980, 2100, 2130, 707030, 31280, 503940, 20500, 730310, 276810, 232810, 671510, 463530, 372000, 1122720, 307960, 667970, 1170950, 339340, 526160, 718670, 410320, 921630, 214510, 32430, 899440, 673610, 433950, 63380, 102600, 232010, 728530, 4570, 2300, 2630, 410340, 234080, 285310, 1184050, 4580, 933820, 21100, 1148650, 2870, 607890, 363890, 814370, 373930, 1123770, 233610, 232910, 868360, 914800, 593280, 233980, 57900, 451020, 363150, 970830, 1064730, 815780, 21000, 400750, 994730, 1148590, 20, 719890, 32510, 913740, 327890, 21130, 363680, 231160, 222730, 572890, 572410, 233470, 22100, 215280, 1016120, 673130, 247000, 332200, 784080, 245280, 214730, 502800, 1108370, 511470, 32500, 265890, 1054490, 307880, 232790, 42670, 104200, 785740, 207170, 363930, 1045520, 4560, 601050, 45740, 2700, 382560, 1161170, 265210, 1041720, 718850, 559210, 480650, 274900, 432350, 18500, 421040, 354240, 558990, 353560, 113020, 277430, 400630, 307110, 434170, 205950, 511680, 32360, 844930, 440650, 568570, 1618540, 285330, 22000, 292140, 2620, 694280, 6880, 578330, 285160, 720280, 879160, 831560, 477740, 631510, 809140, 373770, 331870, 274500, 441870, 222750, 579180, 372360, 981430, 307670, 1135300, 1004240, 3320, 6220, 266210, 345180, 64000, 246090, 963690, 759740, 980300, 287630, 411830, 1172450, 30, 258180, 6030, 577940, 345350, 559100, 329130, 543900, 34010, 34019, 60, 233150, 275100, 867290, 461950, 543460, 382140, 512250, 623940, 213330, 493200, 410110, 615610, 214770, 433550, 420560, 364420, 2320, 354380, 33220, 33229, 433530, 1148510, 292910, 256190, 291550, 107310, 798490, 964800, 795630, 853770, 434050, 421120, 353270, 899970, 1101450, 22230, 318430, 569860, 591370, 671440, 994220, 286040, 1184160, 308420, 108200, 205910, 1520, 360, 445190, 286000, 434730, 411370, 1101190, 6800, 22180, 257750, 1053680, 673750, 244870, 452060, 591420, 306760, 2400, 21980, 244710, 992640, 738540, 363440, 329490, 1044620, 2270, 914710, 374030, 6550, 2200, 525510, 821880, 33460, 718560, 1016600, 1126310, 1028630, 214170, 214870, 371970, 624270, 1123050, 329440, 317250, 879420, 22340, 318600, 525480, 1040230, 232770, 306660, 265610, 720560, 1112790, 667720, 286260, 58610, 373390, 853550, 246840, 267530, 244930, 592260, 503350, 338170, 373180, 231200, 353640, 552700, 421050, 318020, 6900, 434260, 1112890, 214250, 844590, 711660, 712730, 3330, 1148150, 963710, 244770, 1149660, 19980, 246580, 552590, 339230, 1930, 233740, 616110, 411960, 785790, 591460, 447290, 1039880, 785260, 963930, 365160, 1054510, 921390, 107200, 6850, 434460, 275390, 477770, 274290, 22120, 798460, 534550, 307230, 222980, 821250, 6830, 6120, 6129, 381120, 625340, 102840, 447150, 720620, 266130, 543870, 552280, 785770, 502280, 1160490, 650760, 232750, 707010, 32400, 292410, 318130, 439700, 1040420, 33100, 327860, 245490, 22350, 22360, 22362, 1042800, 720250, 672630, 1076200, 584640, 33900, 4850, 434030, 339350, 637670, 338390, 2820, 2210, 1160220, 285500, 421170, 32460, 22200, 900040, 446560, 4720, 651670, 958400, 63710, 1005300, 20530, 355050, 914260, 1161490, 970570, 463270, 968970, 913550, 231740, 3020, 451760, 420740, 382110, 282760, 318100, 600990, 57640, 420000, 331480, 585410, 45700, 511740, 914010, 433100, 345660, 758990, 275670, 695290, 667600, 346560, 695630, 559610, 223330, 318220, 772540, 593200, 1489630, 6920, 233840, 317820, 868520, 441790, 543260, 274270, 40, 284460, 970500, 61700, 1510, 728740, 1045720, 1173400, 602320, 718590, 1244950, 751440, 274560, 232050, 433910, 6310, 1100410, 283160, 20570, 33320, 233230, 770390, 914020, 440880, 345260, 431600, 810670, 307860, 284390, 1161870, 307050, 6200, 863590, 1245540, 585710, 572430, 889510, 1123830, 577690, 1700, 963000, 430210, 592580, 32380, 400940, 215160, 440310, 274230, 345820, 738530, 962400, 1123450, 585450, 265330, 651150, 844850, 274310, 411560, 331440, 328070, 1004270, 1042780, 233550, 20540, 1245430, 19830, 32330, 433170, 477870, 855740, 1100990, 344850, 571880, 760650, 431180, 1108590, 31270, 275200, 1243830, 863570, 441830, 1200, 1184770, 31290, 331500, 551770, 345390, 578850, 420440, 1078350, 33120, 945710, 2610, 246760, 257030, 758870, 585690, 751630, 1619750, 363360, 105000, 451520, 1137300, 683900, 266410, 331670, 1066130, 862800, 616250, 934780, 577670, 331690, 452440, 809230, 878380, 947300, 586200, 502820, 1043260, 1173200, 410710, 525360, 274350, 107300, 257170, 1064460, 214360, 865610, 390520, 718650, 245390, 542050, 266310, 440540, 1040070, 668210, 2640, 231330, 957790, 246110, 214700, 244910, 1171310, 285440, 865090, 355150, 712190, 477730, 244430, 244730, 445310, 283680, 1100930, 932850, 353330, 2500, 503580, 615120, 339200, 1385730, 1043390, 410850, 294810, 673000, 1041840, 283290, 6510, 1005930, 233700, 363600, 970960, 750050, 1089630, 318230, 267490, 1159640, 285110, 1100970, 21670, 831980, 363130, 1173010, 452570, 570460, 962580, 1100260, 551730, 811320, 1640, 934930, 434420, 809020, 420930, 585020, 285800, 410980, 440760, 673800, 256370, 3390, 671800, 2290, 1618230, 234040, 214420, 231140, 502370, 33680, 750130, 1386900, 223510, 214830, 277450, 843810, 381780, 207080, 1490610, 328760, 446790, 1043340, 585550, 1135810, 107600, 214970, 947600, 353700, 6010, 285740, 447120, 292180, 946720, 772430, 256330, 214790, 318530, 329860, 585900, 1077520, 1630, 450860, 798510, 390340, 868980, 855640, 1101140, 284750, 585840, 223220, 982270, 1159560, 671620, 63910, 865540, 1066260, 1172470, 890720, 503620, 706020, 1054800, 821890, 63610, 364930, 551860, 760890, 1029210, 1079160, 552080, 593960, 6300, 981750, 1135240, 205990, 1244630, 42120, 440730, 274980, 591630, 502940, 345610, 1039890, 275530, 6040, 265690, 631570, 1041920, 573120, 1065970, 327560, 770810, 346730, 63200, 63209, 307580, 2450, 463150, 331160, 994890, 1171270, 339190, 364390, 463210, 345890, 440630, 671970, 1113570, 292990, 843260, 1113680, 265590, 284770, 534370, 57740, 353540, 22310, 1172650, 6840, 441550, 363970, 292930, 63940, 797400, 992910, 317510, 568320, 431650, 285380, 607880, 319050, 381020, 266490, 257690, 968790, 1051810, 879510, 632070, 284050, 284850, 1122680, 759940, 20550, 6420, 1149550, 329070, 1016960, 410670, 287020, 21780, 391070, 292500, 3170, 245450, 22140, 1052990, 809890, 2390, 738510, 1182920, 41900, 1016730, 329830, 1089830, 283960, 1078920, 822930, 327670, 446390, 223490, 993090, 1101790, 1620340, 410890, 1135830, 1100620, 32390, 1018010, 2590, 452510, 560260, 559330, 1004750, 1149440, 694770, 6810, 982290, 814480, 318970, 525700, 58520, 420060, 719750, 1028570, 933940, 666570, 233190, 432010, 287260, 1046820, 1172940, 33600, 969760, 503400, 317620, 451840, 552440, 4890, 1018160, 729000, 6870, 1124180, 3270, 1054550, 257990, 1386780, 32450, 682530, 432100, 720350, 319140, 353550, 844260, 205840, 970560, 45100, 921590, 63700, 265750, 980940, 673210, 42990, 480430, 502770, 284710, 820730, 970510, 431590, 4770, 1900, 233350, 667610, 477270, 19800, 1124660, 307640, 433280, 61500, 21800, 593640, 632000, 355130, 1078760, 286810, 1004490, 345430, 33570, 913060, 434250, 1500, 855630, 795420, 223410, 601810, 440420, 1111450, 614910, 63660, 673260, 284240, 798290, 345370, 345240, 3310, 62100, 233370, 21680, 331470, 525040, 946090, 476530, 42170, 579020, 711980, 275180, 694500, 844660, 33520, 33530, 45400, 345090, 410210, 624970, 492230, 346470, 559680, 346180, 308060, 543140, 337930, 222640, 111600, 810040, 256460, 578720, 660160, 32420, 525620, 43000, 552450, 45300, 1089790, 1172050, 331200, 57650, 257050, 267600, 365020, 739540, 4780, 258010, 214590, 284830, 1064610, 810660, 284870, 503770, 104600, 878670, 900010, 889480, 865040, 285480, 382050, 964570, 480640, 578540, 1100420, 20820, 258050, 560430, 963450, 1042380, 6250, 245150, 32670, 6080, 707300, 512180, 1077290, 502740, 319250, 344910, 3130, 809720, 1100140, 63950, 431260, 711750, 462680, 578900, 58570, 650670, 1016790, 1300, 1078280, 650510, 914690, 1017410, 623880, 783840, 434000, 265630, 207040, 283620, 265810, 33130, 586210, 899390, 542260, 642560, 355060, 1124260, 867490, 287580, 666330, 525680, 651660, 257830, 814740, 410430, 265990, 809880, 578210, 108700, 43190, 525640, 433300, 277460, 409890, 962970, 719590, 308040, 234160, 864060, 1044490, 380750, 512060, 1101360, 328270, 1726190, 286240, 223750, 2360, 33610, 246070, 492630, 105800, 814680, 327740, 63000, 820630, 207150, 578310, 306670, 364050, 1183260, 518920, 1173380, 462990, 57680, 345200, 390290, 307940, 1040550, 266390, 1018020, 421740, 354650, 440640, 421660, 390560, 265830, 244810, 42890, 409850, 45710, 572220, 62000, 650440, 1078420, 560170, 433000, 585890, 292330, 266110, 1242980, 21660, 771350, 420520, 2810, 1137410, 543240, 1173510, 1004770, 245730, 463350, 476650, 32340, 854940, 601530, 601540, 200230, 441050, 512220, 1491340, 33620, 57200, 877810, 673450, 594040, 284950, 1065260, 1125240, 308173, 32620, 1046300, 245370, 1046400, 865820, 1016930, 964650, 22130, 899310, 327880, 421700, 381100, 993740, 331750, 18300, 1184480, 451650, 594130, 355250, 1137350, 651500, 274130, 258220, 233680, 1173410, 854570, 1029550, 476700, 317100, 256010, 854860, 1045180, 266230, 739080, 796790, 400800, 355170, 61520, 328590, 32350, 291910, 21010, 363330, 338140, 354160,286460, 111900, 2710, 365660, 275290, 569800, 614630, 363490, 411330, 331360, 445110, 390660, 751820, 245300, 682570, 1015930, 57620, 1076550, 559620, 331920, 111800, 968870, 274250, 591380, 630720, 364300, 58550, 446840, 4800, 2420, 231040, 409870, 3260, 630900, 390030, 206370, 993110, 112100, 1047010, 372390, 257970, 400450, 1149940, 308270, 283940, 1045620, 284890, 257670, 354680, 933300, 411000, 1112930, 463220, 431710, 246300, 33110, 995050, 671390, 1101180, 434210, 809440, 32680, 256390, 821790, 1043500, 969700, 463030, 1054430, 1076920, 363980, 577480, 462960, 287200, 526140, 1160330, 1044980, 728240, 1078330, 3300, 630610, 1135910, 720030, 32150, 569530, 1530, 821500, 317040, 706560, 601770, 286320, 1065100, 921710, 1690, 108500, 585830, 292600, 450670, 682480, 957720, 266170, 400660, 865830, 63800, 912570, 4880, 265970, 809540, 446810, 668350, 463930, 257790, 446380, 771950, 666870, 390720, 380670, 1243670, 785840, 441380, 814530, 275570, 372210, 867380, 246940, 283980, 257400, 431450, 573130, 18820, 451780, 363460, 223710, 464150, 810500, 1065180, 19200, 463170, 630, 1004330, 1015890, 232970, 364270, 981770, 63500, 668550, 1077430, 2800, 1077440, 864160, 433320, 668590, 994140, 933860, 761030, 32630, 214610, 109600, 666820, 355180, 957710, 1076750, 480450, 730050, 284730, 568930, 1525410, 33180, 551450, 231310, 267360, 102850, 434020, 318310, 912370, 2910, 981020, 286480, 1161270, 683940, 1184210, 559910, 365300, 246960, 440520, 363420, 364230, 652190, 739130, 291710, 1101260, 390730, 33650, 346630, 1124830, 231910, 265950, 33670, 783810, 3010, 319170, 58560, 1101580, 889600, 1161190, 338060, 45720, 914290, 1100150, 889770, 345010, 363610, 993790, 573170, 650940, 877360, 441010, 614950, 294750, 390310, 551700, 864680, 257120, 585910, 292060, 363530, 739190, 1016860, 525920, 105300, 866140, 207020, 283080, 286940, 444720, 256030, 813700, 821290, 45000, 492500, 283230, 446640, 292620, 750470, 1079210, 445770, 431940, 1600, 1078200, 992740, 446120, 1045080, 354430, 771920, 584990, 42850, 463980, 844330, 306700, 867180, 223730, 592480, 292630, 285820, 512160, 1491170, 569610, 277110, 864300, 286280, 410820, 659960, 431250, 441670, 111400, 1491710, 760410, 61600, 274480, 441280, 684050, 411760, 1077970, 866190, 339040, 844920, 307340, 994020, 864540, 519080, 411310, 878580, 568750, 650780, 832360, 981890, 867400, 1840, 410840, 18700, 512300, 585180, 534290, 560370, 382260, 344860, 760330, 914110, 317710, 373920, 364690, 542400, 440550, 585950, 1005120, 45450, 559960, 337360, 292480, 338800, 600720, 1112830, 287220, 1243220, 608120, 283560, 995230, 866510, 266290, 822760, 713530, 105100, 346420, 643200, 390710, 492290, 526370, 750520, 338320, 410970, 444940, 601010, 1670, 373970, 831660, 822990, 1005460, 464100, 889750, 666610, 533480, 452420, 214910, 2540, 2545, 2550, 364640, 660920, 569770, 822800, 317850, 750290, 33770, 552160, 214630, 420100, 1078490, 502750, 292800, 1077410, 933450, 1245780, 542350, 1243960, 809730, 32640, 493080, 492270, 206760, 306630, 463850, 447170, 1043240, 758730, 45730, 584930, 543930, 244410, 331190, 809870, 364910, 479130, 1490130, 586240, 31700, 1076880, 331650, 446620, 255920, 337350, 3450, 1043230, 345860, 421810, 541930, 267610, 32900, 61730, 444770, 346460, 106000, 1183470, 542770, 1125330, 232950, 533950, 257930, 277490, 652410, 3050, 751500, 785480, 728440, 1489970, 411080, 899160, 431770, 1041400, 329460, 749960, 868150, 982220, 382090, 2780, 750170, 796860, 738610, 31830, 452860, 390610, 400580, 1148480, 890970, 344840, 306550, 223430, 354400, 410570, 450700, 328940, 372930, 1077530, 339130, 283600, 345120, 355240, 2840, 1066180, 759440, 1111940, 511140, 233800, 479010, 751240, 512080, 577460, 337490, 783590, 543010, 420980, 1183500, 543390, 32310, 58200, 785780, 771420, 981260, 318090, 42500, 573060, 431750, 1046660, 569810, 255870, 1065020, 668430, 432980, 1135230, 434620, 451880, 946990, 439910, 200210, 1088870, 294830, 400510, 222660, 4870, 462940, 809210, 738550, 1184420, 946610, 718330, 570050, 3410, 879000, 1015920, 2350, 32750, 447190, 1184760, 267060, 963400, 245050, 552130, 593030, 568720, 31810, 651380, 771810, 462100, 492150, 372940, 718370, 286540, 6090, 381750, 382300, 1172510, 493060, 1182760, 551690, 444880, 275060, 831570, 525380, 631900, 695050, 1313, 4520, 992730, 451570, 345330, 695100, 695600, 42210, 445020, 292780, 673600, 233210, 1045840, 431810, 446000, 328500, 1125480, 749800, 61510, 102200, 511090, 1016770, 1610, 420660, 99900, 294670, 1028800, 42140, 223450, 1524750, 1078320, 570420, 363520, 706490, 751300, 1039940, 809280, 286140, 594050, 291630, 287120, 306490, 306680, 623700, 444970, 1054340, 439920, 729530, 32770, 963280, 431120, 586350, 1490460, 821560, 682450, 569970, 307130, 338130, 463860, 364940, 720150, 821060, 946010, 1028350, 276870, 276890, 796620, 935070, 502710, 1490840, 1046230, 451010, 552390, 914750, 244590, 1149400, 21600, 592030, 328220, 1089840, 968760, 890570, 339210, 328730, 1126420, 511350, 668320, 671900, 337420, 444800, 1161880, 292230, 1150090, 1040730, 2340, 331810, 363090, 332260, 1101400, 446040, 331970, 6400, 447200, 332360, 1100800, 1065940, 223630, 391000, 266090, 543030, 33990, 292160, 462930, 433600, 1101930, 552460, 1148810, 337850, 912450, 43600, 277500, 980830, 1160360, 585080, 373750, 286830, 737520, 614860, 512230, 631830, 284260, 364630, 451600, 372690, 1111810, 1079000, 63900, 431910, 1040460, 815450, 914170, 1125110, 420840, 963330, 1018000, 44690, 525610, 1387590, 105420, 543180, 1244800, 844040, 287070, 337480, 1004610, 327930, 111100, 420770, 291930, 1184400, 579110, 551620, 1183030, 21030, 307760, 4460, 42980, 1076210, 673850, 421190, 1100160, 577730, 615010, 3380, 1054710, 317320, 32760, 329650, 286660, 276340, 1727000, 390200, 444690, 1182830, 450950, 431930, 1243890, 864550, 815000, 503370, 345060, 372750, 451920, 409920, 284990, 421630, 760630, 230980, 492340, 631980, 400790, 329200, 1065200, 713460, 719200, 1017060, 338190, 292420, 246680, 666940, 2330, 737890, 275470, 573080, 284100, 560000, 286770, 337720, 1135260, 820610, 586310, 1041710, 331510, 291960, 615350, 338980, 578930, 1089780, 1125390, 1112340, 585190, 338120, 214130, 265470, 958320, 409910, 463110, 363950, 962630, 772290, 1064860, 317970, 1126750, 4530, 287371, 1045650, 411320, 593490, 382380, 864100, 434410, 6270, 502240, 577990, 275080, 450850, 946110, 205810, 329190, 760640, 307570, 821640, 381870, 503180, 215080, 355270, 245430, 591790, 1136330, 285960, 233410, 446780, 1044870, 750990, 1005400, 568440, 1160020, 345540, 760460, 1149510, 411570, 431700, 751640, 420180, 283660, 373240, 1124060, 257220, 365260, 642610, 946660, 1044450, 461890, 683830, 445800, 913890, 1005950, 889700, 2900, 275510, 43100, 879670, 738920, 420550, 652660, 434370, 451990, 440020, 713260, 364820, 245010, 214550, 707580, 31840, 286360, 570490, 480480, 3350, 631540, 666730, 317360, 502230, 577530, 1126990, 365670, 913850, 331390, 267340, 614030, 964020, 463760, 650490, 981300, 559260, 233310, 1726730, 285010, 337820, 346500, 292390, 525240, 328470, 32610, 578800, 434190, 432470, 718200, 854250, 584800, 1029240, 854770, 206690, 338530, 390910, 593330, 31850, 31880, 382420, 623640, 286380, 1078510, 364510, 104000, 257630, 1490410, 542340, 570000, 337680, 913780, 400740, 283920, 434880, 439930, 32730, 559870, 934540, 63650, 783940, 869170, 1171240, 1122780, 32160, 1137450, 2370, 345230, 661040, 585290, 244750, 287600, 584890, 772610, 889710, 42220, 245410, 319080, 277390, 914140, 1159860, 233110, 865270, 759570, 844420, 306640, 814300, 1039830, 738650, 345080, 749840, 60800, 63110, 318330, 346140, 318650, 957050, 390670, 43500, 932980, 1077450, 510680, 843720, 373650, 63960, 577970, 1040630, 282860, 464080, 205830, 476920, 57700, 363110, 332330, 291690, 771240, 31930, 1015800, 1854980, 1044340, 206610, 223280, 431280, 109500, 815210, 1015940, 434740, 772500, 551370, 820540, 307010, 1385780, 214570, 809000, 1028130, 593530, 843440, 6210, 432940, 877850, 346220, 865980, 21640, 651340, 809850, 624120, 705340, 683280, 1045430, 811070, 760810, 770410, 292200, 353630, 283270, 382330, 1148560, 868380, 287370, 642770, 463290, 913330, 1245950, 1183720, 751450, 809310, 993980, 1042170, 33580, 292240, 108110, 821320, 1102100, 205870, 946650, 968950, 729660, 331980, 332250, 444930, 411120, 878420, 1101760, 434290, 31860, 1386890, 329040, 559310, 32650, 1113030, 844500, 337880, 720240, 327950, 446310, 1243880, 31820, 1064130, 1126190, 1045350, 760800, 1101270, 3230, 277470, 593900, 968550, 233510, 1045340, 380660, 363410, 502570, 1054690, 729030, 233530, 533850, 921530, 317530, 318690, 213350, 601380, 820900, 275350, 673300, 400470, 867140, 354620, 750200, 33980, 1017520, 277270, 579120, 1016720, 1100430, 560250, 964130, 672860, 3430, 1122690, 503240, 246980, 372350, 308600, 749850, 447180, 796940, 291770, 410990, 750800, 282780, 1171440, 344820, 1108350, 2570, 390220, 1126890, 207190, 441350, 820910, 615770, 1076230, 338960, 1243420, 651490, 1111620, 308460, 1387290, 256070, 331880, 1004210, 286750, 572620, 1149710, 502720, 292400, 491650, 292660, 431840, 503340, 354740, 729720, 1112620, 33730, 4420, 1045610, 592390, 615250, 1162010, 1492200, 434680, 661000, 865250, 759540, 1525460, 452970, 552030, 31890, 255960, 510930, 577740, 1490250, 463160, 292570, 31910, 1064660, 206250, 865850, 61100, 1173350, 1489500, 1079130, 630550, 615780, 1043860, 772180, 32660, 559900, 572520, 42810, 615180, 282880, 759000, 843430, 511430, 705710, 365320, 993340, 673190, 542200, 492180, 1006270, 31920, 1172520, 729460, 822830, 868080, 285070, 441440, 560720, 1065950, 1385650, 1619540, 1619790, 1243200, 214150, 771560, 247307];
        set_time_limit(10000000);
        $steamApps = json_decode(Http::get('https://api.steampowered.com/ISteamApps/GetAppList/v2/?access_token=c54705e41cc1c3bde731e3659aa55b67'))->applist->apps;
        $gamesinTable = DB::table('games')->get('steam_id');
        $existingApps = [];
        foreach ($gamesinTable as $game) {
            $existingApps[] = $game->steam_id;
        }
        $newApps = [];
        foreach ($steamApps as $app) {
            if (!in_array($app->appid, $existingApps)) {
                $newApps[] = $app->appid;
            }
        }

        sort($newApps);

        foreach ($newApps as $appid) {
            print_r($appid . '<br>');
            if (DB::table('games')->where('steam_id', $appid)->doesntExist()) {
                $appDetails = json_decode(Http::get('https://store.steampowered.com/api/appdetails/', [
                    'appids' => $appid,
                    'l' => 'english',
                    'cc' => 'EE'
                ]), true);
                if ($appDetails != null) {
                    $appDetails = $appDetails[$appid];
                    if ($appDetails['success'] == true) {
                        $appDetails = $appDetails['data'];
                        if (isset($appDetails['recommendations']) && $appDetails['recommendations'] > 200 && $appDetails['type'] == 'game') {
                            $gameDBID = DB::table('games')
                                ->insertGetId([
                                    'steam_id' => $appid,
                                    'type' => $appDetails['type'],
                                    'banned' => false,
                                    'title' => $appDetails['name'],
                                    'description' => $appDetails['detailed_description'],
                                    'about' => $appDetails['about_the_game'],
                                    'languages' =>  isset($appDetails['supported_languages']) ? $appDetails['supported_languages'] : NULL,
                                    'notes' =>  isset($dlcDetails['content_descriptors']['notes']) ? $dlcDetails['content_descriptors']['notes'] : NULL,
                                    'release_date' =>  isset($appDetails['release_date']) ? $appDetails['release_date']['date'] : NULL,
                                    'steam_url' =>  'https://store.steampowered.com/app/' . $appDetails['steam_appid'],
                                    'metacritic' =>  isset($appDetails['metacritic'], $appDetails['metacritic']['score']) ? $appDetails['metacritic']['score'] : NULL,
                                    'metacritic_url' =>  isset($appDetails['metacritic'], $appDetails['metacritic']['url']) ? $appDetails['metacritic']['url'] : NULL,
                                    'recommendations' =>  isset($appDetails['recommendations'], $appDetails['recommendations']['total']) ? $appDetails['recommendations']['total'] : NULL,
                                    'is_free' => $appDetails['is_free'],
                                    'current_steam_price' => isset($appDetails['price_overview']['final']) ? $appDetails['price_overview']['final'] : NULL,
                                    'best_price' => isset($appDetails['price_overview']['final']) ? $appDetails['price_overview']['final'] : NULL,
                                    'best_store' => 'steam',
                                    'windows' => isset($appDetails['platforms']['windows']) ? $appDetails['platforms']['windows'] : NULL,
                                    'pc_recommended' => isset($appDetails['pc_requirements']['recommended']) ? $appDetails['pc_requirements']['recommended'] : NULL,
                                    'pc_minimum' => isset($appDetails['pc_requirements']['minimum']) ? $appDetails['pc_requirements']['minimum'] : NULL,
                                    'linux' => isset($appDetails['platforms']['linux']) ? $appDetails['platforms']['linux'] : NULL,
                                    'linux_recommended' => isset($appDetails['linux_requirements']['recommended']) ? $appDetails['linux_requirements']['recommended'] : NULL,
                                    'linux_minimum' => isset($appDetails['linux_requirements']['minimum']) ? $appDetails['linux_requirements']['minimum'] : NULL,
                                    'mac' => isset($appDetails['platforms']['mac']) ? $appDetails['platforms']['mac'] : NULL,
                                    'mac_recommended' => isset($appDetails['mac_requirements']['recommended']) ? $appDetails['mac_requirements']['recommended'] : NULL,
                                    'mac_minimum' => isset($appDetails['mac_requirements']['minimum']) ? $appDetails['mac_requirements']['minimum'] : NULL,
                                ]);
                            
                            DB::table('game_images')->insert([
                                'type' => 'header',
                                'full' => $appDetails['header_image'],
                                'game_id' => $gameDBID,
                            ]);

                            if (isset($appDetails['package_groups']['subs'])) {
                                foreach ($appDetails['package_groups']['subs'] as $sub) {
                                    if (DB::table('packages')->where('steam_package_id', $sub['packageid'])->doesntExist()) {
                                        DB::table('packages')->insert([
                                            'game_id' => $gameDBID,
                                            'steam_package_id' => $sub['packageid'],
                                            'option_text' => $sub['option_text'],
                                            'option_description' => $sub['option_description'],
                                            'is_free' => $sub['is_free_licence'],
                                            'price' => $sub['price_in_cents_with_discount'],
                                        ]);
                                    }
                                }
                            }
                            if (isset($appDetails['categories'])) {
                                foreach ($appDetails['categories'] as $category) {
                                    if (DB::table('game_tags_definitions')->where('name', $category['description'])->doesntExist()) {
                                        $tagDefId = DB::table('game_tags_definitions')->insertGetId([
                                            'name' => $category['description'],
                                            'type' => 'category'
                                        ]);
                                        DB::table('game_tags_mappings')->insert([
                                            'game_id' => $gameDBID,
                                            'tag_id' => $tagDefId
                                        ]);
                                    }
                                }
                            }
                            if (isset($appDetails['genres'])) {
                                foreach ($appDetails['genres'] as $genre) {
                                    if (DB::table('game_tags_definitions')->where('name', $genre['description'])->doesntExist()) {
                                        $tagDefId = DB::table('game_tags_definitions')->insertGetId([
                                            'name' => $genre['description'],
                                            'type' => 'genre'
                                        ]);
                                        DB::table('game_tags_mappings')->insert([
                                            'game_id' => $gameDBID,
                                            'tag_id' => $tagDefId
                                        ]);
                                    }
                                }
                            }
                            if (isset($appDetails['developers'])) {
                                foreach ($appDetails['developers'] as $developer) {
                                    if (DB::table('game_credits_definitions')->where('name', $developer)->doesntExist()) {
                                        $creditDefId = DB::table('game_credits_definitions')->insertGetId([
                                            'name' => $developer,
                                            'type' => 'developer'
                                        ]);
                                        DB::table('game_credits_mappings')->insert([
                                            'game_id' => $gameDBID,
                                            'credit_id' => $creditDefId
                                        ]);
                                    }
                                }
                            }
                            if (isset($appDetails['publishers'])) {
                                foreach ($appDetails['publishers'] as $publisher) {
                                    if (DB::table('game_credits_definitions')->where('name', $publisher)->doesntExist()) {
                                        $creditDefId = DB::table('game_credits_definitions')->insertGetId([
                                            'name' => $publisher,
                                            'type' => 'publisher'
                                        ]);
                                        DB::table('game_credits_mappings')->insert([
                                            'game_id' => $gameDBID,
                                            'credit_id' => $creditDefId
                                        ]);
                                    }
                                }
                            }
                            if (isset($appDetails['screenshots'])) {
                                foreach ($appDetails['screenshots'] as $image) {
                                    DB::table('game_images')->insert([
                                        'type' => 'thumbnail',
                                        'thumbnail' => $image['path_thumbnail'],
                                        'full' => $image['path_full'],
                                        'game_id' => $gameDBID,
                                    ]);
                                }
                            }
                            if (isset($appDetails['movies'])) {
                                foreach ($appDetails['movies'] as $video) {
                                    DB::table('game_videos')->insert([
                                        'name' => $video['name'],
                                        'thumbnail' => $video['thumbnail'],
                                        'video_480p' => $video['mp4']['480'],
                                        'video_max' => $video['mp4']['max'],
                                        'game_id' => $gameDBID,
                                    ]);
                                }
                            }
                            if (isset($appDetails['dlc'])) {
                                foreach ($appDetails['dlc'] as $dlcid) {
                                    if (DB::table('games')->where('steam_id', $dlcid)->doesntExist()) {
                                        $dlcDetails = json_decode(Http::get('https://store.steampowered.com/api/appdetails/', [
                                            'appids' => $dlcid,
                                            'l' => 'english',
                                            'cc' => 'EE'
                                        ]), true);
                                        if ($dlcDetails != null) {
                                            $dlcDetails = $dlcDetails[$dlcid];
                                            if ($dlcDetails['success'] == true) {
                                                $dlcDetails = $dlcDetails['data'];
                                                $dlcDBID = DB::table('games')
                                                    ->insertGetId([
                                                        'steam_id' => $dlcid,
                                                        'type' => $dlcDetails['type'],
                                                        'banned' => false,
                                                        'title' => $dlcDetails['name'],
                                                        'description' => $dlcDetails['detailed_description'],
                                                        'about' => $dlcDetails['about_the_game'],
                                                        'languages' =>  isset($dlcDetails['supported_languages']) ? $dlcDetails['supported_languages'] : NULL,
                                                        'notes' =>  isset($dlcDetails['content_descriptors']['notes']) ? $dlcDetails['content_descriptors']['notes'] : NULL,
                                                        'steam_url' =>  'https://store.steampowered.com/app/' . $dlcDetails['steam_appid'],
                                                        'metacritic' =>  isset($dlcDetails['metacritic'], $dlcDetails['metacritic']['score']) ? $dlcDetails['metacritic']['score'] : NULL,
                                                        'metacritic_url' =>  isset($dlcDetails['metacritic'], $dlcDetails['metacritic']['url']) ? $dlcDetails['metacritic']['url'] : NULL,
                                                        'recommendations' =>  isset($dlcDetails['recommendations'], $dlcDetails['recommendations']['total']) ? $dlcDetails['recommendations']['total'] : NULL,
                                                        'is_free' => $dlcDetails['is_free'],
                                                        'current_steam_price' => isset($dlcDetails['price_overview']['final']) ? $dlcDetails['price_overview']['final'] : NULL,
                                                        'best_price' => isset($dlcDetails['price_overview']['final']) ? $dlcDetails['price_overview']['final'] : NULL,
                                                        'best_store' => 'steam',
                                                        'windows' => isset($dlcDetails['platforms']['windows']) ? $dlcDetails['platforms']['windows'] : NULL,
                                                        'pc_recommended' => isset($dlcDetails['pc_requirements']['recommended']) ? $dlcDetails['pc_requirements']['recommended'] : NULL,
                                                        'pc_minimum' => isset($dlcDetails['pc_requirements']['minimum']) ? $dlcDetails['pc_requirements']['minimum'] : NULL,
                                                        'linux' => isset($dlcDetails['platforms']['linux']) ? $dlcDetails['platforms']['linux'] : NULL,
                                                        'linux_recommended' => isset($dlcDetails['linux_requirements']['recommended']) ? $dlcDetails['linux_requirements']['recommended'] : NULL,
                                                        'linux_minimum' => isset($dlcDetails['linux_requirements']['minimum']) ? $dlcDetails['linux_requirements']['minimum'] : NULL,
                                                        'mac' => isset($dlcDetails['platforms']['mac']) ? $dlcDetails['platforms']['mac'] : NULL,
                                                        'mac_recommended' => isset($dlcDetails['mac_requirements']['recommended']) ? $dlcDetails['mac_requirements']['recommended'] : NULL,
                                                        'mac_minimum' => isset($dlcDetails['mac_requirements']['minimum']) ? $dlcDetails['mac_requirements']['minimum'] : NULL,
                                                    ]);
                            
                                                    DB::table('game_images')->insert([
                                                        'type' => 'header',
                                                        'full' => $dlcDetails['header_image'],
                                                        'game_id' => $dlcDBID,
                                                    ]);
                        
                                                    if (isset($dlcDetails['package_groups']['subs'])) {
                                                    foreach ($dlcDetails['package_groups']['subs'] as $sub) {
                                                        if (DB::table('packages')->where('steam_package_id', $sub['packageid'])->doesntExist()) {
                                                            DB::table('packages')->insert([
                                                                'game_id' => $dlcDBID,
                                                                'steam_package_id' => $sub['packageid'],
                                                                'option_text' => $sub['option_text'],
                                                                'option_description' => $sub['option_description'],
                                                                'is_free' => $sub['is_free_licence'],
                                                                'price' => $sub['price_in_cents_with_discount'],
                                                            ]);
                                                        }
                                                    }
                                                }
                                                if (isset($dlcDetails['categories'])) {
                                                    foreach ($dlcDetails['categories'] as $category) {
                                                        if (DB::table('game_tags_definitions')->where('name', $category['description'])->doesntExist()) {
                                                            $tagDefId = DB::table('game_tags_definitions')->insertGetId([
                                                                'name' => $category['description'],
                                                                'type' => 'category'
                                                            ]);
                                                            DB::table('game_tags_mappings')->insert([
                                                                'game_id' => $dlcDBID,
                                                                'tag_id' => $tagDefId
                                                            ]);
                                                        }
                                                    }
                                                }
                                                if (isset($dlcDetails['genres'])) {
                                                    foreach ($dlcDetails['genres'] as $genre) {
                                                        if (DB::table('game_tags_definitions')->where('name', $genre['description'])->doesntExist()) {
                                                            $tagDefId = DB::table('game_tags_definitions')->insertGetId([
                                                                'name' => $genre['description'],
                                                                'type' => 'genre'
                                                            ]);
                                                            DB::table('game_tags_mappings')->insert([
                                                                'game_id' => $dlcDBID,
                                                                'tag_id' => $tagDefId
                                                            ]);
                                                        }
                                                    }
                                                }
                                                if (isset($dlcDetails['developers'])) {
                                                    foreach ($dlcDetails['developers'] as $developer) {
                                                        if (DB::table('game_credits_definitions')->where('name', $developer)->doesntExist()) {
                                                            $creditDefId = DB::table('game_credits_definitions')->insertGetId([
                                                                'name' => $developer,
                                                                'type' => 'developer'
                                                            ]);
                                                            DB::table('game_credits_mappings')->insert([
                                                                'game_id' => $dlcDBID,
                                                                'credit_id' => $creditDefId
                                                            ]);
                                                        }
                                                    }
                                                }
                                                if (isset($dlcDetails['publishers'])) {
                                                    foreach ($dlcDetails['publishers'] as $publisher) {
                                                        if (DB::table('game_credits_definitions')->where('name', $publisher)->doesntExist()) {
                                                            $creditDefId = DB::table('game_credits_definitions')->insertGetId([
                                                                'name' => $publisher,
                                                                'type' => 'publisher'
                                                            ]);
                                                            DB::table('game_credits_mappings')->insert([
                                                                'game_id' => $dlcDBID,
                                                                'credit_id' => $creditDefId
                                                            ]);
                                                        }
                                                    }
                                                }
                                                if (isset($dlcDetails['screenshots'])) {
                                                    foreach ($dlcDetails['screenshots'] as $image) {
                                                        DB::table('game_images')->insert([
                                                            'type' => 'thumbnail',
                                                            'thumbnail' => $image['path_thumbnail'],
                                                            'full' => $image['path_full'],
                                                            'game_id' => $dlcDBID,
                                                        ]);
                                                    }
                                                }
                                                if (isset($dlcDetails['movies'])) {
                                                    foreach ($dlcDetails['movies'] as $video) {
                                                        DB::table('game_videos')->insert([
                                                            'name' => $video['name'],
                                                            'thumbnail' => $video['thumbnail'],
                                                            'video_480p' => $video['mp4']['480'],
                                                            'video_max' => $video['mp4']['max'],
                                                            'game_id' => $dlcDBID,
                                                        ]);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        } else {
                            DB::table('games')->insert([
                                'steam_id' => $appid,
                                'type' => $appDetails['type'],
                                'title' => $appDetails['name'],
                                'banned' => true,
                                'is_free' => $appDetails['is_free'],
                            ]);
                        }
                    }
                }
            }
        }
        return view('admin-panel');
    }
}
